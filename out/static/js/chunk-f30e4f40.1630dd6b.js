(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-f30e4f40"],{2596:function(t,a,e){},ab70:function(t,a,e){"use strict";e.r(a);var s=function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("div",{staticClass:"home_wrap"},[s("div",{staticClass:"data_wrap box_back"},[s("div",{staticClass:"top"},[s("div",{staticClass:"lf"},[s("div",{staticClass:"switch_item"},[s("span",[t._v("异常停车")]),s("el-switch",{attrs:{"active-color":"#2ea4da","inactive-color":"#999999"},on:{change:t.searchChange},model:{value:t.value1,callback:function(a){t.value1=a},expression:"value1"}})],1),s("div",{staticClass:"switch_item"},[s("span",[t._v("越界巡逻")]),s("el-switch",{attrs:{"active-color":"#2ea4da","inactive-color":"#999999"},on:{change:t.searchChange},model:{value:t.value2,callback:function(a){t.value2=a},expression:"value2"}})],1),s("div",{staticClass:"switch_item"},[s("span",[t._v("超速行驶")]),s("el-switch",{attrs:{"active-color":"#2ea4da","inactive-color":"#999999"},on:{change:t.searchChange},model:{value:t.value3,callback:function(a){t.value3=a},expression:"value3"}})],1)]),s("div",{staticClass:"rg"},[s("div",{staticClass:"switch_item"},[s("span",[t._v("公里桩")]),s("el-switch",{attrs:{"active-color":"#30d8a4","inactive-color":"#999999"},on:{change:t.showHidePiles},model:{value:t.value4,callback:function(a){t.value4=a},expression:"value4"}})],1)])]),s("div",{staticClass:"select_wrap"},[s("div",{staticClass:"select"},[s("el-cascader",{attrs:{options:t.orgList,props:{expandTrigger:"hover"},clearable:"",separator:"-",placeholder:"请选择机构"},on:{change:t.selectOrgChange},model:{value:t.selectOrg,callback:function(a){t.selectOrg=a},expression:"selectOrg"}})],1),s("div",{staticClass:"select"},[s("el-input",{staticClass:"common-focus",attrs:{placeholder:"请输入车号"},nativeOn:{keyup:function(a){return"button"in a||!t._k(a.keyCode,"enter",13,a.key,"Enter")?t.searchByCard(a):null}},model:{value:t.card,callback:function(a){t.card=a},expression:"card"}},[s("i",{staticClass:"el-input_icon el-icon-search",staticStyle:{"line-height":"30px","margin-right":"2px",cursor:"pointer"},attrs:{slot:"suffix"},on:{click:t.searchByCard},slot:"suffix"})])],1)]),s("div",{staticClass:"table_wrap"},[t._m(0),s("div",{staticClass:"table_bd"},[s("ul",t._l(t.currentData,function(a,i){return s("li",{key:i,class:i===t.listActive?"active":"",on:{click:function(e){t.focusCar(a,i)}}},[s("span",{staticClass:"ch ellipsis",attrs:{title:a.plateNo}},[t._v(t._s(a.plateNo))]),s("span",{staticClass:"jg ellipsis",attrs:{title:a.orgName}},[t._v(t._s(a.orgName))]),s("span",{class:["zt","red","ellipsis"],attrs:{title:a.illegalType}},[t._v(t._s(a.illegalType))]),s("span",{staticClass:"dd ellipsis",attrs:{title:a.illegalAddr}},[t._v(t._s(a.illegalAddr))]),s("span",{staticClass:"cz ellipsis"},[s("img",{attrs:{src:e("d8e81"),alt:""},on:{click:function(e){t.handleClick(a,i)}}})])])}),0)]),t.currentData.length?t._e():s("div",{staticClass:"noData"},[t._v("暂无数据！")]),s("div",{staticClass:"pageBox"},[s("el-pagination",{attrs:{background:"",small:"","current-page":t.currentPage,"page-size":5,layout:"total, prev, pager, next, jumper",total:t.totalCount,"pager-count":5},on:{"current-change":t.handleCurrentChange}})],1)])]),s("div",{directives:[{name:"show",rawName:"v-show",value:t.showDetail,expression:"showDetail"}],staticClass:"detail_wrap box_back"},[s("div",{staticClass:"top"},[s("div",{staticClass:"out"},[t._v("\n        轨迹查询\n        "),s("div",{staticClass:"export_btn"},[s("a",{attrs:{href:t.exportUrl}},[s("img",{attrs:{src:e("610e"),alt:""}}),s("span",[t._v("导出")])])])]),s("div",{staticClass:"close_btn el-icon-close",on:{click:function(a){t.showDetail=!1}}})]),s("div",{staticClass:"lf"},[s("div",{staticClass:"mid"},[s("span",[t._v(t._s(t.activeData.plateNo))]),s("span",{staticClass:"ellipsis",staticStyle:{width:"135px"},attrs:{title:t.activeData.orgName}},[t._v(t._s(t.activeData.orgName))]),s("div",{staticClass:"timeSelecBox"},[s("dateTime",{attrs:{defaultstart:t.defaultstart,defaultend:t.defaultend},on:{change:t.dateTimeChange},model:{value:t.searchTime,callback:function(a){t.searchTime=a},expression:"searchTime"}})],1),s("img",{attrs:{src:e("f959"),alt:""},on:{click:function(a){t.getLocusDetail(t.activeData)}}})]),s("div",{staticClass:"cont"},[s("div",{staticClass:"cl"},[s("div",{staticClass:"c_lf"},[t._m(1),s("div",[s("span",[t._v("最大车速")]),s("p",[t._v(t._s(t.locusDetail.gps?t.locusDetail.gps.maxSpeed:0)+" km/h")])]),s("div",[s("span",[t._v("累计停车")]),s("p",[t._v(t._s(t.locusDetail.gps?t.locusDetail.gps.tccs:0)+" 次")])])]),s("div",{staticClass:"c_md"},[t._m(2),t._m(3),s("div",[s("span",[t._v("超速")]),s("p",[t._v(t._s(t.locusDetail.overspeedCount||0)+"次")])])]),s("div",{staticClass:"c_rg"},[s("el-scrollbar",{staticStyle:{height:"100%"}},[s("ul",t._l(t.locusDetail.wfjcList,function(a,e){return s("li",{key:e},[s("span",{staticClass:"tit"},[t._v(t._s(a.illegalType))]),s("span",{staticClass:"ct"},[t._v(t._s(a.illegalTime)+"   "+t._s(a.speed))])])}),0)])],1)])])]),s("div",{staticClass:"rg"},[s("div",{staticClass:"rl"},[s("h6",[t._v("播放速度")]),s("div",{staticClass:"speed"},t._l(t.speedList,function(a,e){return s("div",{key:e,staticClass:"item",class:t.speedActive===e?"active":"",on:{click:function(a){t.selectSpeed(e)}}},[t._v(t._s(a))])}),0),s("el-progress",{attrs:{"text-inside":!0,"stroke-width":18,percentage:50}}),s("div",{staticClass:"cz_btn"},[s("div",{staticClass:"item",on:{click:t.toPlay}},[s("img",{attrs:{src:e("d8e81"),alt:""}}),s("span",[t._v("播放")])]),s("div",{staticClass:"item",on:{click:t.replay}},[s("img",{attrs:{src:e("392b"),alt:""}}),s("span",[t._v("回放")])])])],1),s("div",{staticClass:"rr"},[t._m(4),s("div",{staticClass:"policeList"},[s("el-scrollbar",{staticStyle:{height:"100%"}},[s("ul",t._l(t.locusDetail.mjList,function(a,e){return s("li",{key:e},[s("span",[t._v(t._s(a.xm)+"("+t._s(a.police)+")")]),s("span",[t._v(t._s(a.finEmforCementCount.counts))]),s("span",[t._v(t._s(a.accidentCount.counts))]),s("span",[t._v(t._s(a.kkjcCount.counts))])])}),0)])],1)])])]),t.showPlay?s("div",{staticClass:"playBox"},[s("polylinePlay",{ref:"playDom",attrs:{speed:t.speed,polylineData:t.polylineData},on:{close:function(a){t.showPlay=!1}}})],1):t._e()])},i=[function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"table_hd"},[e("span",{staticClass:"ch"},[t._v("车号")]),e("span",{staticClass:"line"}),e("span",{staticClass:"jg"},[t._v("机构")]),e("span",{staticClass:"line"}),e("span",{staticClass:"zt"},[t._v("行驶状态")]),e("span",{staticClass:"line"}),e("span",{staticClass:"dd"},[t._v("地点")]),e("span",{staticClass:"line"}),e("span",{staticClass:"cz"},[t._v("操作")])])},function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",[e("span",[t._v("起点终点")]),e("p",[t._v("-")])])},function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",[e("span",[t._v("里程")]),e("p",[t._v("-")])])},function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",[e("span",[t._v("均速")]),e("p",[t._v("-")])])},function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"rr_hd"},[e("span",[t._v("民警")]),e("span",[t._v("现场纠违")]),e("span",[t._v("简易事故")]),e("span",[t._v("检查核录")])])}],l=(e("ac6a"),e("28a5"),e("2bed")),c=e("86a8"),n=e("ba19"),o={name:"current",data:function(){return{value1:!0,value2:!0,value3:!0,value4:!1,selectOrg:"",card:"",value7:null,listActive:0,showDetail:!1,currentPage:1,totalCount:0,currentData:[],defaultstart:"",defaultend:"",searchTime:"",locusDetail:{},activeData:{},showPlay:!1,speedList:["x1","x2","x4","x8","x16"],speedActive:0,speed:1,polylineData:{}}},filters:{formatterStatus:function(t){return 0===t?"行车异常":1===t?"行车正常":void 0}},components:{dateTime:l["a"],polylinePlay:c["a"]},computed:{exportUrl:function(){var t=this.searchTime.split("&");return"".concat('"http://10.118.112.32:8280/gs_police_supervision"',"/tblPoliceCarIllegalInfo/export?startTime=").concat(t[0],"&endTime=").concat(t[1],"&plateNo=").concat(this.activeData.plateNo)}},created:function(){var t="2019-08-02";this.filterTime=t,this.defaultstart=t+" 00:00:00",this.defaultend=t+" 23:59:59",this.searchTime="".concat(this.defaultstart,"&").concat(this.defaultend),this.getCurrentList()},mounted:function(){var t=this;this.$eventBus.$on("getLocusInfo",function(a){t.showDetail=!0;var e="2019-08-02";if(t.filterTime=e,t.defaultstart=e+" 00:00:00",t.defaultend=e+" 23:59:59",t.searchTime="".concat(t.defaultstart,"&").concat(t.defaultend),t.listActive===a&&t.locusDetail.gps)return!1;t.listActive=a,t.activeData=t.currentData[a],t.getLocusDetail(t.currentData[a])})},methods:{searchChange:function(){this.currentPage=1,this.getCurrentList()},selectOrgChange:function(){this.searchChange()},searchByCard:function(){this.searchChange()},getCurrentList:function(){var t=this,a={startRow:5*(this.currentPage-1),endRow:5};this.value1&&(a.stopCar="异常停车"),this.value2&&(a.crossingPatrol="越界巡逻"),this.value3&&(a.speedDing="超速",a.lowSpeed="低速"),this.card&&(a.plateNo=this.card),this.selectOrg[1]&&(a.orgCode=this.selectOrg[1]),this.listActive=0,this.showDetail=!1,this.locusDetail={},n["a"].getCurrentList(a).then(function(a){if(console.log(a),"0"===a.code){t.currentData=a.data.returnTblPoliceCarIllegalList||[],t.totalCount=a.data.counts||0,a.data.returnTblPoliceCarIllegalList[0]&&(t.activeData=a.data.returnTblPoliceCarIllegalList[0],t.$store.commit("setPantoData",[a.data.returnTblPoliceCarIllegalList[0].lon,a.data.returnTblPoliceCarIllegalList[0].lat]));var e=[];t.currentData.forEach(function(t){e.push({title:t.plateNo,point:[t.lon,t.lat]})}),t.$store.commit("setLocusData",e)}else t.currentData=[],t.totalCount=0})},getLocusDetail:function(t){var a=this,e=this.searchTime.split("&"),s={startTime:e[0],endTime:e[1],plateNo:t.plateNo,gpsId:t.plateNo,jgbm:t.orgCode};n["a"].getLocusDetail(s).then(function(e){if(console.log(e),"0"===e.code){var s=0;e.data.wfjcList.forEach(function(t){"超速"===t.illegalType&&s++}),e.data.overspeedCount=s,a.locusDetail=e.data||{},e.data.gps&&(a.$store.commit("setPolylineData",{center:[t.lon,t.lat],shiji:e.data.gps.gps||[],lilun:e.data.xlGps.GzfwList||[]}),a.polylineData=e.data.gps.gps)}else a.locusDetail={}})},handleCurrentChange:function(t){this.currentPage=t,this.getCurrentList()},focusCar:function(t,a){this.listActive=a,this.activeData=t,this.$store.commit("setPantoData",[t.lon,t.lat])},handleClick:function(t,a){this.showDetail=!0;var e="2019-08-02";if(this.filterTime=e,this.defaultstart=e+" 00:00:00",this.defaultend=e+" 23:59:59",this.searchTime="".concat(this.defaultstart,"&").concat(this.defaultend),this.listActive===a&&this.locusDetail.gps)return!1;this.listActive=a,this.getLocusDetail(t)},dateTimeChange:function(){},selectSpeed:function(t){this.speedActive=t,0===t?this.speed=1:1===t?this.speed=2:2===t?this.speed=4:3===t?this.speed=8:4===t&&(this.speed=16)},toPlay:function(){this.showPlay=!0},replay:function(){this.$refs.playDom.replay()},showHidePiles:function(t){this.$store.commit("setPileShow",t)}},destroyed:function(){this.$store.commit("setLocusState",!0)}},r=o,u=(e("c0df"),e("2877")),d=Object(u["a"])(r,s,i,!1,null,"f747acd0",null);d.options.__file="current.vue";a["default"]=d.exports},c0df:function(t,a,e){"use strict";var s=e("2596"),i=e.n(s);i.a}}]);